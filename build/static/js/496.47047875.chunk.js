"use strict";(self.webpackChunkreact_mk_blogging=self.webpackChunkreact_mk_blogging||[]).push([[496],{8115:(e,s,t)=>{t.r(s),t.d(s,{default:()=>C});var a=t(8150),l=t(5200),n=t(3588),o=t(3389),i=t(5823),d=t(7462),r=t(253),c=t(1732),u=t(5883),m=t(6032),h=t(6004),g=t(9810),p=t(5043),j=t(4858),x=t(5475),b=t(6543),f=t(2823),y=t.n(f),v=(t(5884),t(9628)),k=t(6728),N=t(7154);var D=t(948),E=t.n(D),w=t(579);f.Quill.register("modules/imageUploader",k.A);const C=()=>{const[e]=(0,x.ok)(),s=e.get("id"),[t,f]=(0,p.useState)(""),{control:k,watch:D,setValue:C,handleSubmit:S,getValues:V,reset:J,formState:{isValid:A,isSubmitting:P}}=(0,j.mN)({mode:"onChange",defaultValues:{title:"",slug:"",status:2,category:{},hot:!1,image:"",user:{}}}),I=V("image"),R=V("image_name"),{image:U,setImage:_,progress:G,handleSelectImage:H,handleDeleteImage:T}=(0,h.A)(C,V,R,(async function(){const e=(0,m.H9)(u.db,"posts",s);await(0,m.mZ)(e,{image:""})}));const F=D("status"),O=D("hot");(0,p.useEffect)((()=>{_(I)}),[I,_]),(0,p.useEffect)((()=>{!async function(){if(!s)return;const e=(0,m.H9)(u.db,"posts",s),t=await(0,m.x7)(e);var a,l;t.data()&&(J(t.data()),Z((null===(a=t.data())||void 0===a?void 0:a.category)||""),f((null===(l=t.data())||void 0===l?void 0:l.content)||" "))}()}),[s,J]);const[q,L]=(0,p.useState)([]),[M,Z]=(0,p.useState)("");(0,p.useEffect)((()=>{!async function(){const e=(0,m.rJ)(u.db,"categories"),s=(0,m.P)(e,(0,m._M)("status","==",1)),t=await(0,m.GG)(s);let a=[];t.forEach((e=>{a.push({id:e.id,...e.data()})})),L(a)}()}),[]);const Q=(0,p.useMemo)((()=>({toolbar:[["bold","italic","underline","strike"],["blockquote"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{header:[1,2,3,4,5,6,!1]}],["link","image"]],imageUploader:{upload:async e=>{const s=new FormData;s.append("image",e);const t=await(0,N.A)({method:"post",url:"https://api.imgbb.com/1/upload?key=de365e406f31414674096a7d8e9babb8",data:s,headers:{"Content-Type":"multipart/form-data"}});return console.log("\ud83d\ude80 ~ upload: ~ response:",t),t.data.data.url}}})),[]);return s?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(g.A,{title:"Update post",desc:"Update post content"}),(0,w.jsxs)("form",{onSubmit:S((async e=>{if(!A)return;const a=(0,m.H9)(u.db,"posts",s);e.status=Number(e.status),e.slug=E()(e.slug||e.title,{lower:!0}),await(0,m.mZ)(a,{...e,image:U,content:t}),v.oR.success("Update post successfully!")})),children:[(0,w.jsxs)("div",{className:"form-layout",children:[(0,w.jsxs)(o.D,{children:[(0,w.jsx)(r.J,{children:"Title"}),(0,w.jsx)(d.p,{control:k,placeholder:"Enter your title",name:"title",required:!0})]}),(0,w.jsxs)(o.D,{children:[(0,w.jsx)(r.J,{children:"Slug"}),(0,w.jsx)(d.p,{control:k,placeholder:"Enter your slug",name:"slug"})]})]}),(0,w.jsxs)("div",{className:"form-layout",children:[(0,w.jsxs)(o.D,{children:[(0,w.jsx)(r.J,{children:"Image"}),(0,w.jsx)(i.A,{className:"h-[250px]",onChange:H,handleDeleteImage:T,progress:G,image:U})]}),(0,w.jsxs)(o.D,{children:[(0,w.jsx)(r.J,{children:"Category"}),(0,w.jsxs)(n.m,{children:[(0,w.jsx)(n.m.Select,{placeholder:"Select the category"}),(0,w.jsx)(n.m.List,{children:q.length>0&&q.map((e=>(0,w.jsx)(n.m.Option,{onClick:()=>(async e=>{const s=(0,m.H9)(u.db,"categories",e.id),t=await(0,m.x7)(s);C("category",{id:t.id,...t.data()}),Z(e)})(e),children:e.name},e.id)))})]}),(null===M||void 0===M?void 0:M.name)&&(0,w.jsx)("span",{className:"inline-block p-3 rounded-lg bg-green-50 text-sm text-green-600 font-medium",children:null===M||void 0===M?void 0:M.name})]})]}),(0,w.jsx)("div",{className:"mb-10",children:(0,w.jsxs)(o.D,{children:[(0,w.jsx)(r.J,{children:"Content"}),(0,w.jsx)("div",{className:"w-full entry-content",children:(0,w.jsx)(y(),{modules:Q,theme:"snow",value:t,onChange:f})})]})}),(0,w.jsxs)("div",{className:"form-layout",children:[(0,w.jsxs)(o.D,{children:[(0,w.jsx)(r.J,{children:"Feature post"}),(0,w.jsx)(c.A,{on:!0===O,onClick:()=>C("hot",!O)})]}),(0,w.jsxs)(o.D,{children:[(0,w.jsx)(r.J,{children:"Status"}),(0,w.jsxs)(o.y,{children:[(0,w.jsx)(l.s,{name:"status",control:k,checked:Number(F)===b.jV.APPROVED,value:b.jV.APPROVED,children:"Approved"}),(0,w.jsx)(l.s,{name:"status",control:k,checked:Number(F)===b.jV.PENDING,value:b.jV.PENDING,children:"Pending"}),(0,w.jsx)(l.s,{name:"status",control:k,checked:Number(F)===b.jV.REJECTED,value:b.jV.REJECTED,children:"Reject"})]})]})]}),(0,w.jsx)(a.$,{type:"submit",className:"mx-auto w-[250px]",isLoading:P,disabled:P,children:"Update post"})]})]}):null}}}]);
//# sourceMappingURL=496.47047875.chunk.js.map